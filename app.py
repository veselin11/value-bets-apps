import streamlit as st
import pandas as pd
from datetime import date, timedelta

# –¢–≤–æ–∏—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑–∏ –æ—Ç –≤—á–µ—Ä–∞ (–¥–∞—Ç–∞—Ç–∞ –µ –≤—á–µ—Ä–∞—à–Ω–∞)
yesterday = date.today() - timedelta(days=1)
today = date.today()

def get_predictions():
    return [
        # –í—á–µ—Ä–∞—à–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏ (—Ç–≤–æ–∏—Ç–µ)
        {"–î–∞—Ç–∞": str(yesterday), "–ú–∞—á": "Sirius vs Mj√§llby (Allsvenskan, –®–≤–µ—Ü–∏—è)", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "–ü–æ–±–µ–¥–∞ Mj√§llby (1X2)", "–ö–æ–µ—Ñ": 1.95, "–°—É–º–∞": 40,
         "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "Mj√§llby —Å–∞ –ª–∏–¥–µ—Ä–∏ –≤ –ª–∏–≥–∞—Ç–∞, —Å –æ—Ç–ª–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞ –∏ –Ω–∞–π-–¥–æ–±—ä—Ä –≥–æ—Å—Ç—É–≤–∞—â —Ä–µ–∫–æ—Ä–¥. Sirius —Å–∞ –≤ –ª–æ—à–∞ —Ñ–æ—Ä–º–∞ —É –¥–æ–º–∞, —Å 4 –∑–∞–≥—É–±–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 6 –º–∞—á–∞."},
        
        {"–î–∞—Ç–∞": str(yesterday), "–ú–∞—á": "Sirius vs Mj√§llby", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "–ù–∞–¥ 2.5 –≥–æ–ª–∞", "–ö–æ–µ—Ñ": 1.60, "–°—É–º–∞": 20,
         "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "Mj√§llby –æ—Ç–∫—Ä–∏—Ç–æ –≤–∫–∞—Ä–≤–∞—Ç –≥–æ–ª–æ–≤–µ, –∞ Sirius —á–µ—Å—Ç–æ –¥–æ–ø—É—Å–∫–∞—Ç –≤—Ä–∞—Ç–∞—Ç–∞ —Å–∏ ‚Äì H2H –∏–º–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –Ω–∞–¥ 3 –≥–æ–ª–∞."},
        
        {"–î–∞—Ç–∞": str(yesterday), "–ú–∞—á": "Athletic Club vs Ava√≠ (–ë—Ä–∞–∑–∏–ª–∏—è, S√©rie B)", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "–ü–æ–±–µ–¥–∞ Ava√≠ (1X2)", "–ö–æ–µ—Ñ": 2.50, "–°—É–º–∞": 10,
         "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "Ava√≠ –∏–º–∞ –∑–Ω–∞—á–∏—Ç–µ–ª–µ–Ω –ø—Ä–µ–≤–µ—Å —Å–ø—Ä—è–º–æ —Å–ª–∞–±–∞—Ç–∞ —Ñ–æ—Ä–º–∞ –Ω–∞ Athletic Club, —Å CheckForm‚Ñ¢ 6 —Å—Ä–µ—â—É 0, –ø–æ–∑–∏—Ü–∏—è 4 —Å—Ä–µ—â—É 20."},
        
        # –î–Ω–µ—à–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏ (–ø—Ä–∏–º–µ—Ä)
        {"–î–∞—Ç–∞": str(today), "–ú–∞—á": "Kairat - Olimpija", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "–ü–æ–¥ 2.5", "–ö–æ–µ—Ñ": 1.65, "–°—É–º–∞": 40, "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "–ò –¥–≤–∞—Ç–∞ –æ—Ç–±–æ—Ä–∞ –∏–≥—Ä–∞—è—Ç –¥–µ—Ñ–∞–Ω–∑–∏–≤–Ω–æ –≤ –µ–≤—Ä–æ—Ç—É—Ä–Ω–∏—Ä–∏—Ç–µ, –æ—á–∞–∫–≤–∞ —Å–µ –ø—Ä–µ–¥–ø–∞–∑–ª–∏–≤ –ø–æ–¥—Ö–æ–¥."},
        {"–î–∞—Ç–∞": str(today), "–ú–∞—á": "Malmo - Saburtalo", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "–ù–∞–¥ 2.5", "–ö–æ–µ—Ñ": 1.60, "–°—É–º–∞": 20, "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "Malmo –∏–≥—Ä–∞–µ –æ—Ñ–∞–Ω–∑–∏–≤–Ω–æ —É –¥–æ–º–∞, –∞ Saburtalo –¥–æ–ø—É—Å–∫–∞ –≥–æ–ª–æ–≤–µ –ø–æ—á—Ç–∏ –≤—ä–≤ –≤—Å–µ–∫–∏ –º–∞—á."},
        {"–î–∞—Ç–∞": str(today), "–ú–∞—á": "Uruguay W - Argentina W", "–ü—Ä–æ–≥–Ω–æ–∑–∞": "1", "–ö–æ–µ—Ñ": 2.00, "–°—É–º–∞": 10, "–†–µ–∑—É–ª—Ç–∞—Ç": "–û—á–∞–∫–≤–∞ —Å–µ",
         "–û–±–æ—Å–Ω–æ–≤–∫–∞": "–£—Ä—É–≥–≤–∞–π –µ –≤ –ø–æ-–¥–æ–±—Ä–∞ —Ñ–æ—Ä–º–∞ –∏ –∏–º–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ –ø—Ä–µ–¥–∏–º—Å—Ç–≤–æ —Å–ª–µ–¥ –ø—Ä–µ–¥–∏—à–Ω–∏ –ø–æ–±–µ–¥–∏."}
    ]

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
if 'initial_bank' not in st.session_state:
    st.session_state.initial_bank = 300  # —Å—Ç–∞—Ä—Ç–æ–≤–∞ –±–∞–Ω–∫–∞ —Å–ø–æ—Ä–µ–¥ –æ–±—è—Å–Ω–µ–Ω–∏–µ—Ç–æ —Ç–∏

if 'df' not in st.session_state:
    st.session_state.df = pd.DataFrame(get_predictions())

df = st.session_state.df

st.title("‚öΩ –ü—Ä–æ–≥–Ω–æ–∑–∏ –∏ –æ–±–æ—Å–Ω–æ–≤–∫–∏")

# –ë–∞–Ω–∫–∞
bank = st.session_state.initial_bank
for _, row in df.iterrows():
    if row["–†–µ–∑—É–ª—Ç–∞—Ç"] == "‚úÖ –ü–µ—á–µ–ª–∏–≤—à":
        bank += row["–°—É–º–∞"] * row["–ö–æ–µ—Ñ"] - row["–°—É–º–∞"]
    elif row["–†–µ–∑—É–ª—Ç–∞—Ç"] == "‚ùå –ì—É–±–µ—â":
        bank -= row["–°—É–º–∞"]

st.subheader("üí∞ –ë–∞–Ω–∫–∞")
st.metric("–¢–µ–∫—É—â –±–∞–ª–∞–Ω—Å", f"{bank:.2f} –ª–≤")

# –¢–∞–±–ª–∏—Ü–∞ –±–µ–∑ –∫–æ–ª–æ–Ω–∞ "–û–±–æ—Å–Ω–æ–≤–∫–∞"
cols_for_table = ["–î–∞—Ç–∞", "–ú–∞—á", "–ü—Ä–æ–≥–Ω–æ–∑–∞", "–ö–æ–µ—Ñ", "–°—É–º–∞", "–†–µ–∑—É–ª—Ç–∞—Ç"]
st.subheader("üìã –ü—Ä–æ–≥–Ω–æ–∑–∏")
st.dataframe(df[cols_for_table], use_container_width=True)

# –ò–∑–±–æ—Ä –Ω–∞ –º–∞—á –∑–∞ –¥–µ—Ç–∞–π–ª–Ω–∞ –æ–±–æ—Å–Ω–æ–≤–∫–∞
st.subheader("üîé –í–∏–∂ –æ–±–æ—Å–Ω–æ–≤–∫–∞")
match_options = [f"{row['–î–∞—Ç–∞']} | {row['–ú–∞—á']}" for _, row in df.iterrows()]
selected = st.selectbox("–ò–∑–±–µ—Ä–∏ –º–∞—á", match_options)
selected_row = df.iloc[match_options.index(selected)]

st.markdown(f"""
### üß† –û–±–æ—Å–Ω–æ–≤–∫–∞ –∑–∞ **{selected_row['–ú–∞—á']}**
- üìÖ –î–∞—Ç–∞: {selected_row['–î–∞—Ç–∞']}
- üéØ –ü—Ä–æ–≥–Ω–æ–∑–∞: **{selected_row['–ü—Ä–æ–≥–Ω–æ–∑–∞']}**
- üí∏ –ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç: {selected_row['–ö–æ–µ—Ñ']}
- üí∞ –°—É–º–∞: {selected_row['–°—É–º–∞']} –ª–≤
- üìà –†–µ–∑—É–ª—Ç–∞—Ç: {selected_row['–†–µ–∑—É–ª—Ç–∞—Ç']}
- üìä –û–±–æ—Å–Ω–æ–≤–∫–∞:
> {selected_row['–û–±–æ—Å–Ω–æ–≤–∫–∞']}
""")
